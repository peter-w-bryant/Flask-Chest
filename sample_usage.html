<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Contributing" href="CONTRIBUTING.html" /><link rel="prev" title="APIs" href="interfaces.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Sample Usage - Flask-Chest</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="_static/_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Flask-Chest</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Flask-Chest</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">APIs</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Sample Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <!-- Import custom.css -->
<link rel="stylesheet" type="text/css" href="_static/custom.css">
<section id="sample-usage">
<h1>Sample Usage<a class="headerlink" href="#sample-usage" title="Link to this heading">#</a></h1>
<section id="example-exporting-slis-to-multiple-targets">
<h2>Example: Exporting SLIs to Multiple Targets<a class="headerlink" href="#example-exporting-slis-to-multiple-targets" title="Link to this heading">#</a></h2>
<p>Suppose you have a Flask app that is serving an API, and you want to report on <a class="reference external" href="https://sre.google/sre-book/service-level-objectives/">Service Level Indicators</a> (SLIs) to both an <u>InfluxDB 2.x instance</u> and <u><a class="reference external" href="https://www.splunk.com/en_us/about-splunk/acquisitions/signalfx.html">SignalFX</a></u>. For this example, your SLIs are <b>total transactions</b> and <b>average response time of POST requests</b> to a single API endpoint. You want to track these SLIs for each request made to the API, and export them to both backends, so that you can <u>monitor and analyze the performance of your API in real-time</u>.<br></p>
<!-- <center>
<figure>
<img src="_static/flask_chest_simple_diagram.png" style="width:600px;"/>
<figcaption>Fig 1: Multi-target data flow diagram showing how data is exported from the view function of a Flask route to multiple backends using the `Flask-Chest` package.</figcaption>
</figure>
</center><br> -->
<p>This example uses the following <code class="docutils literal notranslate"><span class="pre">FlaskChest</span></code> objects:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FlaskChestInfluxDB</span></code>, to establish a connection to an InfluxDB 2.x instance and write data points to a specified bucket.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FlaskChestCustomWriter</span></code>, to post data points to a SignalFX endpoint over HTTP.</p></li>
</ul>
<p>As well as the <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator to track global context variables and write data points to the specified backends.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p>First you must import <code class="docutils literal notranslate"><span class="pre">FlaskChestInfluxDB</span></code>, <code class="docutils literal notranslate"><span class="pre">FlaskChestCustomWriter</span></code>, and the <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator from the <code class="docutils literal notranslate"><span class="pre">flask-chest</span></code>package.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_chest</span> <span class="kn">import</span> <span class="n">FlaskChestCustomWriter</span><span class="p">,</span> <span class="n">FlaskChestInfluxDB</span>
<span class="kn">from</span> <span class="nn">flask_chest.decorator</span> <span class="kn">import</span> <span class="n">flask_chest</span>
</pre></div>
</div>
<p>Then you must initialize each chest object with their respective parameters.</p>
</section>
<section id="flaskchestinfluxdb">
<h2>FlaskChestInfluxDB<a class="headerlink" href="#flaskchestinfluxdb" title="Link to this heading">#</a></h2>
<p>Our <code class="docutils literal notranslate"><span class="pre">FlaskChestInfluxDB</span></code> will:</p>
<ul class="simple">
<li><p>Write data points to an InfluxDB 2.x database running on <code class="docutils literal notranslate"><span class="pre">http://localhost:8086</span></code> to the <code class="docutils literal notranslate"><span class="pre">my-bucket</span></code> bucket in the <code class="docutils literal notranslate"><span class="pre">my-org</span></code> organization with the provided authentication token.</p></li>
<li><p>Include custom tags with each data point.</p></li>
<li><p>Log all messages using the provided logger instance.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chest_influxdb</span> <span class="o">=</span> <span class="n">FlaskChestInfluxDB</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;InfluxDB&quot;</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:8086&quot;</span><span class="p">,</span>
    <span class="n">token</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;INFLUXDB_TOKEN&quot;</span><span class="p">),</span>
    <span class="n">org</span><span class="o">=</span><span class="s2">&quot;my-org&quot;</span><span class="p">,</span>
    <span class="n">bucket</span><span class="o">=</span><span class="s2">&quot;my-bucket&quot;</span><span class="p">,</span>
    <span class="n">custom_tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;your-app-name&quot;</span><span class="p">},</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="flaskchestcustomwriter">
<h2>FlaskChestCustomWriter<a class="headerlink" href="#flaskchestcustomwriter" title="Link to this heading">#</a></h2>
<p>Then we must initialize our <code class="docutils literal notranslate"><span class="pre">FlaskChestCustomWriter</span></code> object, which will post data points to a SignalFX endpoint listening on <code class="docutils literal notranslate"><span class="pre">http://localhost:3000</span></code>. To create an instance of <code class="docutils literal notranslate"><span class="pre">FlaskChestCustomWriter</span></code>, we must write a function that will return a data payload when passed the <a class="reference internal" href="interfaces.html#payload-generator-function"><span class="std std-ref">context tuple list</span></a>.</p>
<p>Here is a simple <b>payload generator</b> that returns a dictionary mapping the index of each 3-tuple in the list of 3-tuples, to the 3-tuple itself.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cust_payload_generator</span><span class="p">(</span><span class="n">context_tuple_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">context_tuple</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">context_tuple_list</span><span class="p">):</span>
        <span class="n">payload</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_tuple</span>
    <span class="k">return</span> <span class="n">payload</span>
</pre></div>
</div>
<p>Our <code class="docutils literal notranslate"><span class="pre">FlaskChestCustomWriter</span></code> will:</p>
<ul class="simple">
<li><p>Use the custom payload generator function to generate the payload for the POST request.</p></li>
<li><p>Log all messages using the provided logger instance.</p></li>
<li><p>Not verify the serverâ€™s TLS certificate.</p></li>
<li><p>Consider HTTP status codes <code class="docutils literal notranslate"><span class="pre">200</span></code> and <code class="docutils literal notranslate"><span class="pre">201</span></code> as success.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chest_signalfx</span> <span class="o">=</span> <span class="n">FlaskChestCustomWriter</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SignalFX&quot;</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;http://localhost:3000&quot;</span><span class="p">,</span>
    <span class="n">payload_generator</span><span class="o">=</span><span class="n">cust_payload_generator</span><span class="p">,</span>
    <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">success_status_codes</span><span class="o">=</span><span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">],</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="flask-chest-decorator">
<h2><code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> Decorator<a class="headerlink" href="#flask-chest-decorator" title="Link to this heading">#</a></h2>
<p>Now that the Flask Chest objects are initialized, we can apply our <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator to our desired Flask route to start exporting. For this example app, lets use the following simple Flask index route,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/api-endpoint&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="nd">@flask_chest</span><span class="p">(</span>
    <span class="n">chests</span><span class="o">=</span><span class="p">[</span><span class="n">chest_influxdb</span><span class="p">,</span> <span class="n">chest_signalfx</span><span class="p">],</span>
    <span class="n">tracked_vars</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;GET&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;transaction&quot;</span><span class="p">],</span>
        <span class="s2">&quot;POST&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;transaction&quot;</span><span class="p">,</span> <span class="s2">&quot;response_time&quot;</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">g</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">g</span><span class="o">.</span><span class="n">transaction</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">start</span>
        <span class="k">return</span> <span class="s2">&quot;Hello, World!&quot;</span>
    <span class="n">g</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">start</span>
    <span class="k">return</span> <span class="s2">&quot;Hello, World!&quot;</span>
</pre></div>
</div>
<p>Another optional parameter we can provide the <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator is a <code class="docutils literal notranslate"><span class="pre">request_id_generator</span></code>. This function will execute every time a request is made to the route. For this example, we will use the current date and time as a formatted string to distinguish requests made to the route.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">custom_request_id_generator</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With our <code class="docutils literal notranslate"><span class="pre">FlaskChest</span></code> objects, our tracked variables dictionary, and our <code class="docutils literal notranslate"><span class="pre">request_id_generator</span></code> function initialized, we can now apply the <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator to our index route like so,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="nd">@flask_chest</span><span class="p">(</span>
    <span class="n">chests</span><span class="o">=</span><span class="p">[</span><span class="n">chest_influxdb</span><span class="p">,</span> <span class="n">chest_signalfx</span><span class="p">],</span>
    <span class="n">tracked_vars</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;GET&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;transaction&quot;</span><span class="p">],</span>
        <span class="s2">&quot;POST&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;transaction&quot;</span><span class="p">,</span> <span class="s2">&quot;response_time&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">request_id_generator</span><span class="o">=</span><span class="n">custom_request_id_generator</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="n">g</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">g</span><span class="o">.</span><span class="n">transaction</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">g</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">start</span>
        <span class="k">return</span> <span class="s2">&quot;Hello, World!&quot;</span>
    <span class="n">g</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">g</span><span class="o">.</span><span class="n">start</span>
    <span class="k">return</span> <span class="s2">&quot;Hello, World!&quot;</span>
</pre></div>
</div>
<p>With the <code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> decorator applied to our route, the <code class="docutils literal notranslate"><span class="pre">Flask-Chest</span></code> package will automatically track and export the global context variables <code class="docutils literal notranslate"><span class="pre">g.transaction</span></code> and <code class="docutils literal notranslate"><span class="pre">g.response_time</span></code> to both the InfluxDB 2.x instance and the SignalFX endpoint every time the route is accessed.</p>
<p>From both databases, you can now monitor and analyze the performance of your API in real-time, and use the data to make informed decisions about the performance of your API. For transaction data, you can perform a sum aggregation to get the total number of transactions made to the API, and for response time data, you can perform an average aggregation to get the average response time of POST requests to the API.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="CONTRIBUTING.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contributing</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="interfaces.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">APIs </div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Peter Bryant
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Sample Usage</a><ul>
<li><a class="reference internal" href="#example-exporting-slis-to-multiple-targets">Example: Exporting SLIs to Multiple Targets</a></li>
<li><a class="reference internal" href="#imports">Imports</a></li>
<li><a class="reference internal" href="#flaskchestinfluxdb">FlaskChestInfluxDB</a></li>
<li><a class="reference internal" href="#flaskchestcustomwriter">FlaskChestCustomWriter</a></li>
<li><a class="reference internal" href="#flask-chest-decorator"><code class="docutils literal notranslate"><span class="pre">flask_chest</span></code> Decorator</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=e2f847f2"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>